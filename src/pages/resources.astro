---
import BaseLayout from '@/layouts/BaseLayout.astro';
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import { PageHeroPro } from '@/components/PageHeroPro';
import SectionHeader from '@/components/ui/SectionHeader.astro';
import { siteConfig } from '@/data/siteConfig';
import { makeHref } from '@/lib/nav';
import { getPublicResponsiveImage } from '@/lib/publicImages';
import { RotatingImage } from '@/components/ui/RotatingImage';

const title = `Resources | ${siteConfig.brand.name}`;
const description =
  'Checklists and practical guides for office cleaning scope, walkthroughs, and setting expectations. Print-friendly and built for busy teams.';

const href = makeHref(import.meta.env.BASE_URL);

const heroImage = getPublicResponsiveImage(
  'gallery/services/restocking-02.jpg',
  import.meta.env.BASE_URL,
  {
    sizes: '100vw',
  }
);

const heroImageMobile = getPublicResponsiveImage(
  'gallery/services/restocking-03.jpg',
  import.meta.env.BASE_URL,
  {
    sizes: '100vw',
  }
);

const makeHeroImage = (src: string, srcMobile: string, position = '50% 45%') => {
  const desktop = getPublicResponsiveImage(src, import.meta.env.BASE_URL, { sizes: '100vw' });
  const mobile = getPublicResponsiveImage(srcMobile, import.meta.env.BASE_URL, { sizes: '100vw' });
  return {
    src,
    srcSet: desktop.srcSet,
    sizes: desktop.sizes,
    srcMobile,
    srcSetMobile: mobile.srcSet,
    sizesMobile: mobile.sizes,
    position,
    alt: 'Breakroom and supplies restocking in an office',
  };
};

const heroImages = [
  makeHeroImage(
    'gallery/services/restocking-02.jpg',
    'gallery/services/restocking-03.jpg',
    '50% 45%'
  ),
  makeHeroImage(
    'gallery/services/janitorial-02.jpg',
    'gallery/services/janitorial-03.jpg',
    '50% 45%'
  ),
  makeHeroImage('gallery/services/detail-02.jpg', 'gallery/services/detail-03.jpg', '50% 50%'),
];

const resources = [
  {
    eyebrow: 'Checklist',
    title: 'Office cleaning checklist',
    desc: 'Use for walkthroughs, vendor comparisons, and ongoing quality checks.',
    href: href('checklist/'),
    cta: 'View checklist',
    media: [
      'gallery/services/janitorial-01.jpg',
      'gallery/services/janitorial-02.jpg',
      'gallery/services/janitorial-03.jpg',
    ],
  },
  {
    eyebrow: 'Scope',
    title: 'Scope & process',
    desc: 'How scope works: walkthrough, frequency, add-ons, and service levels.',
    href: href('pricing/'),
    cta: 'See scope',
    media: [
      'gallery/services/facilities-01.jpg',
      'gallery/services/facilities-02.jpg',
      'gallery/services/facilities-03.jpg',
    ],
  },
  {
    eyebrow: 'Proof',
    title: 'What clean looks like',
    desc: 'Examples and standards—what we mean by “done”.',
    href: href('about/#proof'),
    cta: 'See proof',
    media: [
      'gallery/services/detail-01.jpg',
      'gallery/services/detail-02.jpg',
      'gallery/services/detail-03.jpg',
    ],
  },
  {
    eyebrow: 'Services',
    title: 'Services overview',
    desc: 'Cleaning, supplies/restocking, facilities support, and specialty add-ons.',
    href: href('services/'),
    cta: 'Explore services',
    media: [
      'gallery/services/restocking-01.jpg',
      'gallery/services/restocking-02.jpg',
      'gallery/services/restocking-03.jpg',
    ],
  },
];
---

<BaseLayout title={title} description={description}>
  <Header slot="header" />

  <PageHeroPro
    client:load
    title="Resources"
    description="Print-friendly tools to scope cleaning, set expectations, and keep quality consistent—without extra meetings."
    imageSrc="gallery/services/restocking-02.jpg"
    imageSrcMobile="gallery/services/restocking-03.jpg"
    imageAlt="Restocking and supplies management photo"
    imageSrcSet={heroImage.srcSet}
    imageSizes={heroImage.sizes}
    imageSrcSetMobile={heroImageMobile.srcSet}
    imageSizesMobile={heroImageMobile.sizes}
    imagePosition="50% 45%"
    images={heroImages}
    rotateIntervalMs={5000}
  />

  <section class="section">
    <div class="container-page">
      <SectionHeader
        align="center"
        eyebrow="Tools"
        heading="Make scope crystal clear"
        description="Pros keep it simple: written scope, checklists, and consistent follow-up. These resources help you do exactly that."
      >
        <a slot="actions" class="btn-secondary" href={href('services/')}>See services</a>
      </SectionHeader>

      <div class="mt-10 grid gap-6 md:grid-cols-2">
        {
          resources.map((r) => (
            <article class="glass-card card-hover relative overflow-hidden p-7">
              <div
                aria-hidden="true"
                class="from-brand-200/14 pointer-events-none absolute inset-0 bg-gradient-to-br via-transparent to-brand-300/10"
              />
              <div class="relative">
                <RotatingImage
                  client:visible
                  sources={(r.media ?? []).map((src) => ({ src, alt: '' }))}
                  intervalMs={5000}
                  className="mb-5 h-32 w-full rounded-2xl"
                  overlayClassName="bg-gradient-to-t from-slate-950/40 via-slate-950/10 to-transparent"
                />
                <p class="text-xs font-semibold uppercase tracking-wider text-brand-600 dark:text-brand-400">
                  {r.eyebrow}
                </p>
                <h2 class="text-strong mt-2 text-xl font-semibold tracking-tight">{r.title}</h2>
                <p class="mt-2 text-sm leading-relaxed text-muted">{r.desc}</p>
                <div class="mt-5">
                  <a class="btn-secondary" href={r.href}>
                    {r.cta}
                  </a>
                </div>
              </div>
            </article>
          ))
        }
      </div>

      <div class="panel panel-muted mt-10 p-6">
        <p class="text-strong text-sm font-semibold">Want a walkthrough-ready quote?</p>
        <p class="mt-2 text-sm text-muted">
          Share your space basics and priorities. We’ll confirm scope + access details and then send
          a clear written quote.
        </p>
        <div class="mt-4 flex flex-col gap-3 sm:flex-row">
          <a class="btn-secondary" href={href('industries/')}>Industries we serve</a>
        </div>
      </div>
    </div>
  </section>

  <Footer slot="footer" />
</BaseLayout>
