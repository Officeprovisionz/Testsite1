@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;

    /* Sticky UI sizing (used for anchor offsets). */
    --header-sticky: 5rem;
    --section-nav-sticky: 3.25rem;

    /* Brand (Teal) — centered on #00B4A6 for fresh, trustworthy feel */
    --color-brand-50: 240 253 250; /* #F0FDFA */
    --color-brand-100: 204 251 241; /* #CCFBF1 */
    --color-brand-200: 153 246 228; /* #99F6E4 */
    --color-brand-300: 94 234 212; /* #5EEAD4 */
    --color-brand-400: 45 212 191; /* #2DD4BF */
    --color-brand-500: 0 180 166; /* #00B4A6 — design spec primary */
    --color-brand-600: 0 153 141; /* #00998D */
    --color-brand-700: 0 128 118; /* #008076 */
    --color-brand-800: 0 102 95; /* #00665F */
    --color-brand-900: 0 77 71; /* #004D47 */
    --color-brand-950: 0 51 47; /* #00332F */

    /* Accent (Coral) — #FF6B6B for CTAs, warm and inviting */
    --color-accent-50: 255 245 245; /* #FFF5F5 */
    --color-accent-100: 255 228 228; /* #FFE4E4 */
    --color-accent-200: 255 200 200; /* #FFC8C8 */
    --color-accent-300: 255 160 160; /* #FFA0A0 */
    --color-accent-400: 255 135 135; /* #FF8787 — dark mode primary */
    --color-accent-500: 255 107 107; /* #FF6B6B — design spec accent */
    --color-accent-600: 230 80 80; /* #E65050 */
    --color-accent-700: 200 55 55; /* #C83737 */
    --color-accent-800: 170 40 40; /* #AA2828 */
    --color-accent-900: 140 30 30; /* #8C1E1E */

    /* Spacing Scale (4-8-12-16-24-32-48-64-96) */
    --space-1: 0.25rem; /* 4px */
    --space-2: 0.5rem; /* 8px */
    --space-3: 0.75rem; /* 12px */
    --space-4: 1rem; /* 16px */
    --space-6: 1.5rem; /* 24px */
    --space-8: 2rem; /* 32px */
    --space-12: 3rem; /* 48px */
    --space-16: 4rem; /* 64px */
    --space-24: 6rem; /* 96px */

    /* Type + layout defaults */
    /* Cleaner, less “bubbly” geometry */
    --radius-card: 0.75rem;
    --radius-control: 0.625rem;
    --shadow-soft: 0 10px 26px -18px rgba(2, 6, 23, 0.18);

    /* Glass system tokens (kept subtle; avoid “AI-ish” over-styling). */
    --glass-blur: 14px;
    --glass-border: rgba(255, 255, 255, 0.15);
    --glass-border-hover: rgba(255, 255, 255, 0.3);
    --glass-bg-a: rgba(255, 255, 255, 0.03);
    --glass-bg-b: rgba(255, 255, 255, 0.08);
    --glass-shadow: 0 10px 30px -24px rgba(2, 6, 23, 0.18);
    --glass-shadow-strong: 0 14px 44px -28px rgba(2, 6, 23, 0.22);

    /* Semantic surfaces (light) — cream base + strong contrast */
    --color-bg: 255 255 255;
    --color-surface: 255 255 255;
    --color-surface-muted: 250 250 249; /* #FAFAF9 */
    --color-border: 214 211 209; /* stone-300 - slightly darker */
    --color-text: 23 23 23; /* #171717 - darker for max contrast */
    --color-text-muted: 38 38 38; /* #262626 - much darker for readability */
    --color-text-subtle: 64 64 64; /* #404040 */

    /* Shadcn UI Variables (Mapped to Brand - Teal #00B4A6) */
    --background: 0 0% 100%;
    --foreground: 0 0% 4%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 4%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 4%;
    /* Primary teal #00B4A6 in HSL: 174° 100% 35% */
    --primary: 174 100% 35%;
    --primary-foreground: 0 0% 100%;
    --secondary: 40 6% 97%;
    --secondary-foreground: 0 0% 4%;
    --muted: 40 6% 97%;
    /* High contrast muted foreground for readability */
    --muted-foreground: 0 0% 23%;
    --accent: 40 6% 97%;
    --accent-foreground: 0 0% 4%;
    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 100%;
    --border: 40 6% 90%;
    --input: 40 6% 90%;
    --ring: 174 100% 35%;
    --radius: 0.5rem;
  }

  /* Forced light mode */
  :root[data-mode='light'] {
    color-scheme: light;
  }

  body {
    @apply relative min-h-screen font-sans antialiased;
    background-color: rgb(var(--color-bg));
    color: rgb(var(--color-text));
  }

  /* Global Background Image - Simplified */
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    /* Clean, premium gradients (subtle depth, no busy imagery) */
    background:
      radial-gradient(900px 520px at 20% 0%, rgba(var(--color-brand-400), 0.1), transparent 62%),
      radial-gradient(820px 520px at 85% 15%, rgba(var(--color-accent-400), 0.08), transparent 68%),
      radial-gradient(980px 640px at 50% 100%, rgba(var(--color-brand-500), 0.07), transparent 70%);
    pointer-events: none;
  }

  /* Remove excessive backdrop blurs to reduce visual noise */
  .container-page,
  section,
  header,
  footer {
    /* Only keep blur on sticky elements if needed, otherwise clean */
  }

  /* Sticky header needs blur */
  header.sticky {
    @apply bg-white/80 backdrop-blur-md dark:bg-slate-950/80;
  }
  /* Forced dark mode */
  :root[data-mode='dark'] {
    color-scheme: dark;
    /* Dark theme — not pure black/white (better readability + less harsh) */
    --color-bg: 15 15 15; /* #0F0F0F */
    --color-surface: 26 26 26; /* #1A1A1A */
    --color-surface-muted: 31 31 31; /* #1F1F1F */
    --color-border: 64 64 64; /* readable borders */
    --color-text: 240 240 240; /* #F0F0F0 */
    --color-text-muted: 212 212 212; /* #D4D4D4 */
    --color-text-subtle: 163 163 163; /* #A3A3A3 */
    --shadow-soft: 0 20px 60px -20px rgba(0, 0, 0, 0.7);

    --glass-border: rgba(255, 255, 255, 0.1);
    --glass-border-hover: rgba(255, 255, 255, 0.2);
    --glass-bg-a: rgba(15, 23, 42, 0.6);
    --glass-bg-b: rgba(15, 23, 42, 0.8);
    --glass-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    --glass-shadow-strong: 0 35px 60px -15px rgba(0, 0, 0, 0.7);

    /* Shadcn Dark Mode */
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 173 85% 42%;
    --primary-foreground: 210 40% 98%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 0 0% 82%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 173 85% 42%;
  }

  /* Auto mode: follow system preference unless forced to light */
  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) {
      color-scheme: dark;
      /* Mirror the dark-mode token set when user is in auto and OS is dark. */
      --color-bg: 15 15 15;
      --color-surface: 26 26 26;
      --color-surface-muted: 31 31 31;
      --color-border: 64 64 64;
      --color-text: 240 240 240;
      --color-text-muted: 212 212 212;
      --color-text-subtle: 163 163 163;
      --shadow-soft: 0 18px 60px -24px rgba(0, 0, 0, 0.55);

      --glass-border: rgba(255, 255, 255, 0.08);
      --glass-border-hover: rgba(255, 255, 255, 0.16);
      --glass-bg-a: rgb(var(--color-surface) / 0.22);
      --glass-bg-b: rgb(var(--color-surface) / 0.42);
      --glass-shadow: 0 22px 70px -36px rgb(0 0 0 / 0.75);
      --glass-shadow-strong: 0 36px 100px -56px rgb(0 0 0 / 0.85);

      /* Shadcn vars MUST also follow auto-dark; otherwise `text-muted-foreground` etc. stay light. */
      --background: 222.2 84% 4.9%;
      --foreground: 210 40% 98%;
      --card: 222.2 84% 4.9%;
      --card-foreground: 210 40% 98%;
      --popover: 222.2 84% 4.9%;
      --popover-foreground: 210 40% 98%;
      --primary: 173 85% 42%;
      --primary-foreground: 210 40% 98%;
      --secondary: 217.2 32.6% 17.5%;
      --secondary-foreground: 210 40% 98%;
      --muted: 217.2 32.6% 17.5%;
      --muted-foreground: 0 0% 82%;
      --accent: 217.2 32.6% 17.5%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 210 40% 98%;
      --border: 217.2 32.6% 17.5%;
      --input: 217.2 32.6% 17.5%;
      --ring: 173 85% 42%;
    }
  }

  /* Theme variants (brand hue ramps). */
  :root[data-theme='teal'] {
    /* same as default */
  }

  :root[data-theme='navy'] {
    --color-brand-50: 239 246 255;
    --color-brand-100: 219 234 254;
    --color-brand-200: 191 219 254;
    --color-brand-300: 147 197 253;
    --color-brand-400: 96 165 250;
    --color-brand-500: 59 130 246;
    --color-brand-600: 37 99 235;
    --color-brand-700: 29 78 216;
    --color-brand-800: 30 64 175;
    --color-brand-900: 30 58 138;
    --color-brand-950: 23 37 84;

    --primary: 221 83% 53%;
    --ring: 221 83% 53%;
  }

  :root[data-theme='emerald'] {
    --color-brand-50: 236 253 245;
    --color-brand-100: 209 250 229;
    --color-brand-200: 167 243 208;
    --color-brand-300: 110 231 183;
    --color-brand-400: 52 211 153;
    --color-brand-500: 16 185 129;
    --color-brand-600: 5 150 105;
    --color-brand-700: 4 120 87;
    --color-brand-800: 6 95 70;
    --color-brand-900: 6 78 59;
    --color-brand-950: 2 44 34;

    /* Keep shadcn primary/ring aligned with the selected theme. */
    --primary: 160 84% 36%;
    --ring: 160 84% 36%;
  }

  :root[data-theme='slate'] {
    --color-brand-50: 248 250 252;
    --color-brand-100: 241 245 249;
    --color-brand-200: 226 232 240;
    --color-brand-300: 203 213 225;
    --color-brand-400: 148 163 184;
    --color-brand-500: 100 116 139;
    --color-brand-600: 71 85 105;
    --color-brand-700: 51 65 85;
    --color-brand-800: 30 41 59;
    --color-brand-900: 15 23 42;
    --color-brand-950: 2 6 23;

    --primary: 215 16% 44%;
    --ring: 215 16% 44%;
  }

  /* Theme variants (dark-mode tuning). */
  :root[data-mode='dark'][data-theme='emerald'] {
    --primary: 160 84% 44%;
    --ring: 160 84% 44%;
    --primary-foreground: 210 40% 98%;
  }

  :root[data-mode='dark'][data-theme='teal'] {
    --primary: 173 85% 42%;
    --ring: 173 85% 42%;
    --primary-foreground: 210 40% 98%;
  }

  :root[data-mode='dark'][data-theme='navy'] {
    --primary: 221 83% 60%;
    --ring: 221 83% 60%;
    --primary-foreground: 210 40% 98%;
  }

  :root[data-mode='dark'][data-theme='slate'] {
    --primary: 215 20% 62%;
    --ring: 215 20% 62%;
    --primary-foreground: 210 40% 98%;
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light'])[data-theme='emerald'] {
      --primary: 160 84% 44%;
      --ring: 160 84% 44%;
      --primary-foreground: 210 40% 98%;
    }

    :root:not([data-mode='light'])[data-theme='teal'] {
      --primary: 173 85% 42%;
      --ring: 173 85% 42%;
      --primary-foreground: 210 40% 98%;
    }

    :root:not([data-mode='light'])[data-theme='navy'] {
      --primary: 221 83% 60%;
      --ring: 221 83% 60%;
      --primary-foreground: 210 40% 98%;
    }

    :root:not([data-mode='light'])[data-theme='slate'] {
      --primary: 215 20% 62%;
      --ring: 215 20% 62%;
      --primary-foreground: 210 40% 98%;
    }
  }

  html {
    scroll-behavior: smooth;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
    /* Mobile: header + section nav stack. */
    scroll-padding-top: calc(var(--header-sticky, 5rem) + var(--section-nav-sticky, 3.25rem));
  }

  @media (min-width: 768px) {
    html {
      /* Desktop: header only. */
      scroll-padding-top: var(--header-sticky, 5rem);
    }
  }

  html[data-scroll-lock='true'],
  html[data-scroll-lock='true'] body {
    overflow: hidden;
    height: 100%;
  }

  * {
    -webkit-tap-highlight-color: transparent;
  }

  body {
    @apply min-h-screen font-sans antialiased;
    background-color: rgb(var(--color-bg));
    color: rgb(var(--color-text));
    letter-spacing: -0.01em;
    line-height: 1.6;
    text-rendering: optimizeLegibility;
    font-feature-settings:
      'kern' 1,
      'liga' 1,
      'calt' 1;
  }

  ::selection {
    background: rgb(var(--color-brand-500) / 0.22);
  }

  :focus-visible {
    outline: 2px solid theme(colors.brand.500);
    outline-offset: 3px;
  }

  main#main-content {
    /* Keep iOS safe-area padding (home indicator) without relying on a removed sticky CTA bar.
       `!important` beats the Tailwind `pb-0` utility used in layout markup. */
    padding-bottom: env(safe-area-inset-bottom) !important;
  }

  a {
    text-underline-offset: 4px;
  }

  /* Mobile tap feedback (subtle): helps users feel that taps registered. */
  @media (hover: none) and (pointer: coarse) {
    a:active {
      opacity: 0.92;
    }
  }

  a,
  button,
  [role='button'] {
    touch-action: manipulation;
  }

  summary::-webkit-details-marker {
    display: none;
  }

  details > summary {
    list-style: none;
  }

  dialog::backdrop {
    background: rgb(2 6 23 / 0.65);
  }

  /* Scroll Progress Indicator — CSS-only, fixed at top */
  .scroll-progress {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    z-index: 9999;
    background: linear-gradient(
      to right,
      rgb(var(--color-brand-500)) var(--scroll-progress, 0%),
      transparent var(--scroll-progress, 0%)
    );
    pointer-events: none;
  }

  /* Links with underline-offset and smooth transitions */
  .link-underline {
    @apply underline decoration-brand-400/40 underline-offset-4 transition-colors hover:decoration-brand-500;
  }

  /* Text shadow utility for hero text on images */
  .text-hero-shadow {
    text-shadow:
      0 2px 8px rgba(0, 0, 0, 0.35),
      0 4px 16px rgba(0, 0, 0, 0.2);
  }

  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }

    *,
    *::before,
    *::after {
      scroll-behavior: auto;
      transition-duration: 0.001ms !important;
      animation-duration: 0.001ms !important;
      animation-iteration-count: 1 !important;
    }
  }
}

@layer components {
  .container-page {
    @apply mx-auto w-full max-w-6xl xl:max-w-7xl;
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  @media (min-width: 1024px) {
    .container-page {
      padding-left: max(2rem, env(safe-area-inset-left));
      padding-right: max(2rem, env(safe-area-inset-right));
    }
  }

  .container-narrow {
    @apply mx-auto w-full max-w-3xl lg:max-w-4xl;
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  .section {
    padding-block: clamp(3.25rem, 6.5vw, 5.75rem);
  }

  @media (min-width: 1024px) {
    .section {
      padding-block: clamp(4rem, 7vw, 7rem);
    }
  }

  /* Decorative section wrapper that stays compatible with tokens + themes.
     Usage: <section class="section section-creative [section-muted]"> ... */
  .section-creative {
    position: relative;
    overflow: hidden;
    isolation: isolate;
  }

  .section-creative::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    opacity: 0.12;
    background-image: radial-gradient(rgb(var(--color-border) / 0.5) 1px, transparent 1px);
    background-size: 18px 18px;
    background-position: -2px -2px;
    -webkit-mask-image: radial-gradient(70% 60% at 50% 0%, #000 0%, transparent 75%);
    mask-image: radial-gradient(70% 60% at 50% 0%, #000 0%, transparent 75%);
  }

  .section-creative::after {
    content: '';
    position: absolute;
    inset: -30% -20% auto;
    height: 22rem;
    pointer-events: none;
    background:
      radial-gradient(60% 65% at 35% 40%, rgb(var(--color-brand-400) / 0.08), transparent 62%),
      radial-gradient(55% 60% at 75% 20%, rgb(var(--color-brand-300) / 0.07), transparent 60%);
    transform: rotate(-6deg);
  }

  .section-creative > * {
    position: relative;
    z-index: 1;
  }

  .card {
    @apply border transition-all duration-300;
    border-color: rgb(var(--color-border));
    background-color: rgb(var(--color-surface));
    border-radius: var(--radius-card);
    /* Varied shadow - use shadow-md equivalent for cards */
    box-shadow:
      0 4px 6px -1px rgb(0 0 0 / 0.07),
      0 2px 4px -2px rgb(0 0 0 / 0.07);
  }

  .card-elevated {
    /* Stronger shadow for featured/highlighted cards */
    box-shadow:
      0 10px 15px -3px rgb(0 0 0 / 0.08),
      0 4px 6px -4px rgb(0 0 0 / 0.08);
  }

  .panel {
    @apply border;
    border-color: rgb(var(--color-border));
    background-color: rgb(var(--color-surface));
    border-radius: var(--radius-card);
    box-shadow: none;
  }

  .panel-muted {
    background-color: rgb(var(--color-surface-muted));
  }

  .card-hover {
    /* Intentionally empty: hover motion is applied only on hover-capable devices below.
       This prevents "sticky hover" behavior on touch screens. */
  }

  .link {
    @apply underline underline-offset-[5px];
    text-decoration-color: rgb(var(--color-brand-400) / 0.5);
    text-decoration-thickness: 1.5px;
    text-decoration-skip-ink: auto;
    transition:
      text-decoration-color 180ms cubic-bezier(0.4, 0, 0.2, 1),
      color 180ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .link:hover {
    text-decoration-color: rgb(var(--color-brand-500));
    color: rgb(var(--color-brand-600));
  }

  .link:focus-visible {
    @apply outline-none ring-2 ring-brand-400 ring-offset-2;
  }

  .link-muted {
    color: rgb(var(--color-text-muted));
  }

  .link-muted:hover {
    color: rgb(var(--color-text));
  }

  .hero-panel {
    background:
      radial-gradient(800px 380px at 15% 10%, rgb(var(--color-brand-300) / 0.22), transparent 55%),
      radial-gradient(800px 380px at 85% 0%, rgb(var(--color-brand-200) / 0.22), transparent 60%),
      linear-gradient(180deg, rgb(var(--color-brand-50) / 0.65), rgb(var(--color-surface)) 55%);
  }

  /* --- Reference-inspired (glass + waves) primitives --- */

  .wave-divider {
    line-height: 0;
    width: 100%;
    pointer-events: none;
  }

  .wave-divider__svg {
    display: block;
    width: 100%;
    height: 3.5rem;
  }

  @media (min-width: 640px) {
    .wave-divider__svg {
      height: 4.5rem;
    }
  }

  .wave-divider--flip {
    transform: scaleY(-1);
  }

  .glass {
    background:
      radial-gradient(900px 300px at 20% 0%, rgb(var(--color-brand-500) / 0.14), transparent 62%),
      linear-gradient(180deg, var(--glass-bg-a), var(--glass-bg-b));
    border-color: var(--glass-border);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
  }

  :root[data-mode='dark'] .glass {
    background: linear-gradient(
      180deg,
      rgb(var(--color-surface) / 0.55),
      rgb(var(--color-surface) / 0.35)
    );
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .glass {
      background: linear-gradient(
        180deg,
        rgb(var(--color-surface) / 0.55),
        rgb(var(--color-surface) / 0.35)
      );
    }
  }

  .glass-card {
    @apply border;
    border-color: var(--glass-border);
    border-radius: var(--radius-card);
    box-shadow: var(--glass-shadow-strong);
    -webkit-backdrop-filter: blur(calc(var(--glass-blur) + 2px));
    backdrop-filter: blur(calc(var(--glass-blur) + 2px));
    transition:
      border-color 220ms cubic-bezier(0.4, 0, 0.2, 1),
      box-shadow 220ms cubic-bezier(0.4, 0, 0.2, 1),
      transform 220ms cubic-bezier(0.4, 0, 0.2, 1);
    background: linear-gradient(180deg, var(--glass-bg-a), var(--glass-bg-b));
  }

  /* A quieter glass panel: less shadow, more "sheet" feel. */
  .glass-panel {
    @apply border;
    border-color: var(--glass-border);
    border-radius: var(--radius-card);
    box-shadow: var(--glass-shadow);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
    transition:
      border-color 300ms cubic-bezier(0.4, 0, 0.2, 1),
      box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1),
      transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
    background: linear-gradient(145deg, var(--glass-bg-a), var(--glass-bg-b));
  }

  .hero-splash {
    position: relative;
    overflow: hidden;
    isolation: isolate;
    padding-top: clamp(3.5rem, 7vw, 6rem);
    padding-bottom: clamp(2.5rem, 6vw, 4.5rem);
    background: linear-gradient(180deg, rgb(var(--color-surface-muted)), rgb(var(--color-bg)) 70%);
  }

  /* Homepage photo hero: let the actual image do the work (less decorative wash). */
  .hero-photo {
    background: transparent;
  }

  .hero-photo::before {
    opacity: 0;
  }

  .hero-splash::before {
    content: '';
    position: absolute;
    inset: -20% -10% -35%;
    pointer-events: none;
    background:
      radial-gradient(60% 55% at 25% 25%, rgb(var(--color-brand-400) / 0.06), transparent 60%),
      radial-gradient(55% 50% at 80% 10%, rgb(var(--color-brand-500) / 0.07), transparent 62%);
    transform: rotate(-3deg);
    opacity: 0.55;
  }

  .hero-splash > * {
    position: relative;
    z-index: 1;
  }

  /* Slightly darker in dark mode for that “premium” hero feel */
  :root[data-mode='dark'] .hero-splash {
    background: linear-gradient(180deg, rgb(var(--color-surface) / 0.35), rgb(var(--color-bg)) 70%);
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .hero-splash {
      background: linear-gradient(
        180deg,
        rgb(var(--color-surface) / 0.35),
        rgb(var(--color-bg)) 70%
      );
    }
  }

  :root[data-mode='dark'] .hero-panel {
    background:
      radial-gradient(800px 380px at 15% 10%, rgb(var(--color-brand-500) / 0.18), transparent 55%),
      radial-gradient(800px 380px at 85% 0%, rgb(var(--color-brand-400) / 0.14), transparent 60%),
      linear-gradient(180deg, rgb(var(--color-brand-900) / 0.35), rgb(var(--color-surface)) 65%);
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .hero-panel {
      background:
        radial-gradient(
          800px 380px at 15% 10%,
          rgb(var(--color-brand-500) / 0.18),
          transparent 55%
        ),
        radial-gradient(800px 380px at 85% 0%, rgb(var(--color-brand-400) / 0.14), transparent 60%),
        linear-gradient(180deg, rgb(var(--color-brand-900) / 0.35), rgb(var(--color-surface)) 65%);
    }
  }

  @media (hover: hover) and (pointer: fine) {
    .glass-card:hover,
    .glass-panel:hover {
      border-color: var(--glass-border-hover);
    }

    .glass-panel:hover {
      box-shadow: var(--glass-shadow-strong);
    }

    .card-hover {
      @apply hover:-translate-y-1 hover:border-brand-100 hover:shadow-lg hover:shadow-brand-900/5;
    }

    .gallery-hover-zoom {
      transition: transform 500ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .group:hover .gallery-hover-zoom {
      transform: scale(1.05);
    }
  }

  @keyframes damraFadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .damra-fade-in {
    animation: damraFadeIn 520ms ease-out;
  }

  .btn {
    @apply inline-flex min-h-12 touch-manipulation select-none items-center justify-center gap-2 px-7 py-3 text-sm font-semibold transition-all duration-200;
    border-radius: var(--radius-control);
    letter-spacing: 0.01em;
  }

  .btn:focus-visible {
    @apply outline-none ring-2 ring-brand-500 ring-offset-2 ring-offset-[rgb(var(--color-bg))];
  }

  .btn-primary {
    @apply btn text-white shadow-sm active:scale-[0.99];
    background-color: rgb(var(--color-brand-700));
    border: 1px solid rgb(var(--color-brand-800) / 0.25);
  }

  .btn-primary:hover {
    background-color: rgb(var(--color-brand-800));
  }

  .btn-primary:disabled,
  .btn-secondary:disabled,
  .btn-accent:disabled {
    @apply opacity-60;
    cursor: not-allowed;
    transform: none;
  }

  /* Accent button - warm gold for important CTAs */
  .btn-accent {
    @apply btn text-white shadow-sm active:scale-[0.99];
    background-color: rgb(var(--color-accent-500));
    border: 1px solid rgb(var(--color-accent-700) / 0.2);
  }

  .btn-accent:hover {
    background-color: rgb(var(--color-accent-600));
  }

  .btn-secondary {
    @apply btn border active:scale-[0.99];
    border-color: rgb(var(--color-border));
    background-color: rgb(var(--color-surface));
    color: rgb(var(--color-text-muted));
  }

  .btn-secondary:hover {
    background-color: rgb(var(--color-surface-muted));
    border-color: rgb(var(--color-border));
    color: rgb(var(--color-text));
  }

  :root[data-mode='dark'] .btn-secondary {
    background-color: rgb(var(--color-surface) / 0.25);
    color: rgb(var(--color-text));
  }
  :root[data-mode='dark'] .btn-secondary:hover {
    background-color: rgb(var(--color-surface) / 0.35);
  }

  /* For dark hero / media overlays (keeps text readable on dark backgrounds). */
  .btn-invert {
    @apply btn border;
    border-color: rgb(255 255 255 / 0.18);
    background-color: rgb(255 255 255 / 0.1);
    color: white;
  }

  .btn-invert:hover {
    background-color: rgb(255 255 255 / 0.16);
    border-color: rgb(255 255 255 / 0.24);
  }

  .icon-btn {
    @apply btn-secondary px-0;
    width: 2.75rem;
  }

  .section-head {
    @apply flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between;
  }

  .eyebrow {
    @apply text-xs font-semibold uppercase tracking-[0.18em];
    color: rgb(var(--color-brand-700));
  }

  :root[data-mode='dark'] .eyebrow {
    color: rgb(var(--color-brand-300));
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .eyebrow {
      color: rgb(var(--color-brand-300));
    }
  }

  .heading-1 {
    @apply text-balance font-serif font-bold tracking-tight;
    font-size: clamp(2.05rem, 3.2vw + 1.15rem, 3.6rem);
    line-height: 1.06;
    color: rgb(var(--color-text));
  }

  .heading-2 {
    @apply text-balance font-serif font-bold tracking-tight;
    font-size: clamp(1.65rem, 2vw + 1.1rem, 2.5rem);
    line-height: 1.12;
    color: rgb(var(--color-text));
  }

  .heading-3 {
    @apply text-balance font-semibold tracking-tight;
    font-size: clamp(1.25rem, 1.05vw + 1.05rem, 1.85rem);
    line-height: 1.22;
    color: rgb(var(--color-text));
  }

  .heading-4 {
    @apply text-balance font-semibold tracking-tight;
    font-size: clamp(1.125rem, 0.6vw + 1rem, 1.35rem);
    line-height: 1.25;
    color: rgb(var(--color-text));
  }

  /* Type scale utilities */
  .text-display {
    @apply font-serif text-5xl font-bold tracking-tight lg:text-6xl;
    color: rgb(var(--color-text));
  }

  .text-title {
    @apply font-serif text-3xl font-semibold tracking-tight lg:text-4xl;
    color: rgb(var(--color-text));
  }

  .text-heading {
    @apply text-xl font-semibold lg:text-2xl;
    color: rgb(var(--color-text));
  }

  .text-body {
    @apply text-base leading-relaxed;
    color: rgb(var(--color-text));
  }

  .text-body-sm {
    @apply text-sm leading-relaxed;
    color: rgb(var(--color-text-muted));
  }

  .text-caption {
    @apply text-xs;
    color: rgb(var(--color-text-subtle));
  }

  .lede {
    @apply mt-2 max-w-prose leading-relaxed;
    font-size: clamp(1rem, 0.55vw + 0.95rem, 1.125rem);
    color: rgb(var(--color-text-muted));
  }

  .input,
  .select,
  .textarea {
    @apply w-full rounded-xl border px-3;
    @apply text-base;
    border-color: rgb(var(--color-border));
    background-color: rgb(var(--color-surface));
    color: rgb(var(--color-text));
    --tw-ring-offset-color: rgb(var(--color-surface));
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2;
    @apply transition-colors;
  }

  .input:hover,
  .select:hover,
  .textarea:hover {
    border-color: rgb(var(--color-border) / 0.75);
  }

  .input[aria-invalid='true'],
  .select[aria-invalid='true'],
  .textarea[aria-invalid='true'] {
    border-color: rgb(239 68 68 / 0.65); /* red-500 */
  }

  /* Group-level invalid styling (used for checkbox groups). */
  [data-services-box][aria-invalid='true'] {
    border-color: rgb(239 68 68 / 0.6);
    background-color: rgb(239 68 68 / 0.04);
  }

  .input::placeholder,
  .textarea::placeholder {
    color: rgb(var(--color-text-subtle));
  }

  .input,
  .select {
    @apply h-11;
  }

  .textarea {
    @apply py-2;
  }

  .checkbox {
    @apply h-4 w-4 rounded border;
    border-color: rgb(var(--color-border));
    background-color: rgb(var(--color-surface));
    accent-color: rgb(var(--color-brand-600));
  }

  .checkbox:focus-visible {
    outline: 2px solid theme(colors.brand.500);
    outline-offset: 3px;
  }

  .safe-bottom-pad {
    padding-bottom: calc(0.75rem + env(safe-area-inset-bottom));
  }

  .pill {
    @apply inline-flex items-center rounded-lg border px-3 py-1 text-xs font-medium;
    border-color: rgb(var(--color-border));
    background-color: rgb(var(--color-surface));
    color: rgb(var(--color-text-muted));
  }

  /* Shared “check list” pattern (used in About, scope panels, etc.). */
  .check-list {
    @apply mt-6 grid gap-3;
  }

  .check-list--compact {
    @apply mt-4 gap-2;
  }

  .check-list > li {
    @apply flex items-start gap-3;
  }

  .check-icon {
    display: inline-flex;
    flex: none;
    align-items: center;
    justify-content: center;
    width: 1.5rem;
    height: 1.5rem;
    margin-top: 0.125rem;
    border-radius: 0.5rem;
    font-size: 0.875rem;
    font-weight: 700;
    background-color: rgb(var(--color-brand-50));
    color: rgb(var(--color-brand-700));
    border: 1px solid rgb(var(--color-brand-200) / 0.85);
  }

  .check-icon--sm {
    width: 1.25rem;
    height: 1.25rem;
    font-size: 0.75rem;
    margin-top: 0.2rem;
  }

  :root[data-mode='dark'] .check-icon {
    background-color: rgb(var(--color-brand-900) / 0.28);
    color: rgb(var(--color-brand-300));
    border-color: rgb(var(--color-brand-700) / 0.45);
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .check-icon {
      background-color: rgb(var(--color-brand-900) / 0.28);
      color: rgb(var(--color-brand-300));
      border-color: rgb(var(--color-brand-700) / 0.45);
    }
  }

  .mobile-menu-overlay {
    @apply fixed inset-0 bg-slate-900/35;
    opacity: 0;
    transition: opacity 160ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  details[data-mobile-menu][open] .mobile-menu-overlay {
    opacity: 1;
  }

  .mobile-menu-panel {
    @apply fixed right-3 w-[min(18rem,calc(100vw-1.5rem))] border;
    border-color: rgb(var(--color-border));
    background-color: rgb(var(--color-surface));
    border-radius: var(--radius-card);
    box-shadow: var(--shadow-soft);
    top: calc(var(--header-sticky, 5rem) - 0.25rem);
    max-height: calc(100dvh - var(--header-sticky, 5rem) - 1.25rem);
    overflow-y: auto;
    overscroll-behavior: contain;

    /* Closed: slightly offscreen; Open: on-screen.
       While dragging, JS sets inline `transform` + `opacity` + `transition` overrides. */
    transform: translateX(0.75rem);
    opacity: 0;
    pointer-events: none;
    transition:
      transform 180ms cubic-bezier(0.4, 0, 0.2, 1),
      opacity 180ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  details[data-mobile-menu][open] .mobile-menu-panel {
    transform: translateX(0);
    opacity: 1;
    pointer-events: auto;
  }

  details[data-mobile-menu]:not([open]) .mobile-menu-overlay {
    display: none;
  }

  header[data-site-header] .header-inner {
    height: 5rem;
    transition:
      height 220ms cubic-bezier(0.4, 0, 0.2, 1),
      transform 220ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  header[data-site-header].is-scrolled .header-inner {
    height: 4.25rem;
  }

  header[data-site-header] .brand-mark {
    height: 2.5rem;
    width: 2.5rem;
    transition: transform 220ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  header[data-site-header].is-scrolled .brand-mark {
    transform: scale(0.92);
  }

  .text-strong {
    color: rgb(var(--color-text));
  }

  .text-muted {
    color: rgb(var(--color-text-muted));
  }

  .text-subtle {
    color: rgb(var(--color-text-subtle));
  }

  .surface {
    background-color: rgb(var(--color-surface));
  }

  .surface-muted {
    background-color: rgb(var(--color-surface-muted));
  }

  .border-app {
    border-color: rgb(var(--color-border));
  }

  .section-muted {
    background-color: rgb(var(--color-surface-muted));
  }

  .app-bar {
    /* Glass overlay at top of page */
    background-color: rgb(var(--color-surface) / 0.04);
    border-color: rgb(var(--color-border) / 0.35);
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
  }

  header[data-site-header].header-transparent.app-bar {
    background-color: transparent;
    border-color: transparent;
    -webkit-backdrop-filter: none;
    backdrop-filter: none;
  }

  header[data-site-header].is-scrolled.app-bar {
    background-color: rgb(var(--color-surface) / 0.86);
    border-color: rgb(var(--color-border) / 0.55);
    -webkit-backdrop-filter: blur(24px);
    backdrop-filter: blur(24px);
    box-shadow: var(--shadow-soft);
  }

  :root[data-mode='dark'] .app-bar {
    background-color: rgb(var(--color-bg) / 0.35);
    border-color: rgb(var(--color-border) / 0.45);
  }

  :root[data-mode='dark'] header[data-site-header].is-scrolled.app-bar {
    background-color: rgb(var(--color-surface) / 0.8);
    border-color: rgb(var(--color-border) / 0.55);
    box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.45);
  }

  .menu-link {
    @apply block rounded-lg px-4 py-3.5 text-sm font-medium;
    color: rgb(var(--color-text-muted));
  }

  .menu-link:hover {
    background-color: rgb(var(--color-surface-muted));
    color: rgb(var(--color-text));
  }

  .page-header {
    border-color: rgb(var(--color-border));
    background:
      radial-gradient(900px 420px at 10% 10%, rgb(var(--color-brand-500) / 0.12), transparent 60%),
      radial-gradient(900px 420px at 90% 12%, rgb(var(--color-brand-400) / 0.1), transparent 60%),
      linear-gradient(180deg, rgb(var(--color-brand-50) / 0.55), rgb(var(--color-bg) / 0) 70%),
      rgb(var(--color-bg));
  }

  .footer-surface {
    background: rgb(var(--color-surface) / 0.03);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    border-top: 1px solid rgb(var(--color-border) / 0.45);
  }

  :root[data-mode='dark'] .footer-surface {
    background: rgb(var(--color-surface) / 0.12);
    border-top: 1px solid rgb(var(--color-border) / 0.5);
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .footer-surface {
      background: rgb(var(--color-surface) / 0.12);
      border-top: 1px solid rgb(var(--color-border) / 0.5);
    }
  }

  :root[data-mode='dark'] .page-header {
    background:
      radial-gradient(900px 420px at 10% 10%, rgb(var(--color-brand-500) / 0.18), transparent 60%),
      radial-gradient(900px 420px at 90% 12%, rgb(var(--color-brand-400) / 0.14), transparent 60%),
      linear-gradient(180deg, rgb(var(--color-brand-900) / 0.35), rgb(var(--color-bg) / 0) 70%),
      rgb(var(--color-bg));
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .page-header {
      background:
        radial-gradient(
          900px 420px at 10% 10%,
          rgb(var(--color-brand-500) / 0.18),
          transparent 60%
        ),
        radial-gradient(
          900px 420px at 90% 12%,
          rgb(var(--color-brand-400) / 0.14),
          transparent 60%
        ),
        linear-gradient(180deg, rgb(var(--color-brand-900) / 0.35), rgb(var(--color-bg) / 0) 70%),
        rgb(var(--color-bg));
    }
  }
}

@layer utilities {
  .bg-grid-black\/\[0\.05\] {
    background-size: 40px 40px;
    background-image:
      linear-gradient(to right, rgba(0, 0, 0, 0.05) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
  }
  .bg-grid-white\/\[0\.05\] {
    background-size: 40px 40px;
    background-image:
      linear-gradient(to right, rgba(255, 255, 255, 0.05) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }

  :root[data-mode='dark'] .text-slate-900 {
    color: rgb(var(--color-text)) !important;
  }
  :root[data-mode='dark'] .text-slate-700 {
    color: rgb(var(--color-text-muted)) !important;
  }
  :root[data-mode='dark'] .text-slate-600,
  :root[data-mode='dark'] .text-slate-500 {
    color: rgb(var(--color-text-subtle)) !important;
  }

  :root[data-mode='dark'] .border-slate-100,
  :root[data-mode='dark'] .border-slate-200,
  :root[data-mode='dark'] .border-slate-300 {
    border-color: rgb(var(--color-border)) !important;
  }

  :root[data-mode='dark'] .bg-white {
    background-color: rgb(var(--color-surface)) !important;
  }
  :root[data-mode='dark'] .bg-slate-50 {
    background-color: rgb(var(--color-surface-muted)) !important;
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-mode='light']) .text-slate-900 {
      color: rgb(var(--color-text)) !important;
    }
    :root:not([data-mode='light']) .text-slate-700 {
      color: rgb(var(--color-text-muted)) !important;
    }
    :root:not([data-mode='light']) .text-slate-600,
    :root:not([data-mode='light']) .text-slate-500 {
      color: rgb(var(--color-text-subtle)) !important;
    }

    :root:not([data-mode='light']) .border-slate-100,
    :root:not([data-mode='light']) .border-slate-200,
    :root:not([data-mode='light']) .border-slate-300 {
      border-color: rgb(var(--color-border)) !important;
    }

    :root:not([data-mode='light']) .bg-white {
      background-color: rgb(var(--color-surface)) !important;
    }
    :root:not([data-mode='light']) .bg-slate-50 {
      background-color: rgb(var(--color-surface-muted)) !important;
    }
  }
}

@layer base {
  body {
    @apply text-base leading-relaxed antialiased selection:bg-brand-500 selection:text-white;
    background-color: rgb(var(--color-bg));
  }

  /* Fixed Background Gradient */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    z-index: -50;
    background-image: var(--asset-hero-bg);
    background-position: center top;
    background-repeat: no-repeat;
    background-attachment: fixed;
    background-size: cover;
    /* Too high makes light sections feel washed out and text less readable. */
    opacity: 0.2;
    pointer-events: none;
  }

  @media (max-width: 768px) {
    body::before {
      /* Avoid scroll-jank on mobile GPUs while keeping the same aesthetic. */
      background-attachment: scroll;
    }
  }

  /* Subtle noise texture overlay for depth */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    z-index: -40;
    background-image: var(--asset-noise, url('/noise.svg'));
    background-repeat: repeat;
    background-size: 200px 200px;
    opacity: 0.03;
    pointer-events: none;
    mix-blend-mode: overlay;
  }

  /* Custom Scrollbar */
  ::-webkit-scrollbar {
    width: 10px;
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background: rgba(156, 163, 175, 0.3);
    border-radius: 5px;
    border: 2px solid transparent;
    background-clip: content-box;
  }
  ::-webkit-scrollbar-thumb:hover {
    background-color: rgba(156, 163, 175, 0.6);
  }
}

/* ==========================================================================
   Print Styles
   ========================================================================== */
@media print {
  /* Reset colors to save ink and improve readability. */
  :root {
    --color-bg: 255 255 255;
    --color-surface: 255 255 255;
    --color-text: 0 0 0;
    --color-text-muted: 55 65 81;
    --color-text-subtle: 107 114 128;
  }

  *,
  *::before,
  *::after {
    background: transparent !important;
    color: #000 !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  body {
    font-size: 12pt;
    line-height: 1.4;
  }

  body::before,
  body::after {
    display: none !important;
  }

  /* Hide non-essential UI elements. */
  header[data-site-header],
  footer,
  .scroll-progress,
  .wave-divider,
  [aria-hidden='true']:not(img),
  details[data-mobile-menu],
  .btn-primary,
  .btn-secondary,
  .btn-accent,
  .btn-invert,
  [data-lightbox-dialog] {
    display: none !important;
  }

  /* Ensure images print and respect their container. */
  img {
    max-width: 100% !important;
    page-break-inside: avoid;
  }

  /* Avoid page breaks inside important elements. */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  blockquote,
  pre,
  figure,
  .glass-card,
  .glass-panel,
  .panel {
    page-break-inside: avoid;
    page-break-after: avoid;
  }

  /* Keep headings with their following content. */
  h1,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }

  /* Show URLs after links (except for internal anchors). */
  a[href^='http']::after {
    content: ' (' attr(href) ')';
    font-size: 0.8em;
    font-weight: normal;
    word-wrap: break-word;
  }

  a[href^='#']::after,
  a[href^='javascript:']::after {
    content: '';
  }

  /* Basic table styling for print. */
  table {
    border-collapse: collapse;
  }

  th,
  td {
    border: 1px solid #ccc;
    padding: 0.5em;
  }

  /* Simplify sections for print. */
  .section {
    padding: 1rem 0 !important;
  }

  .container-page,
  .container-narrow {
    max-width: 100% !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
}
